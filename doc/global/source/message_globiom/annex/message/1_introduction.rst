1 Introduction
====
This part of the document contains the mathematical formulation of MESSAGE as used at IIASA. The so-called matrix generator produces equations according to this formulation, 
the input data determine the form these equations actually take. In its general formulation MESSAGE a dynamic linear programming model with a mixed integer option. 
This implies that all relations that define the structure of a model are given as linear constraints between continuous variables. The variables of such a model are called 
''Columns'', the equations ''Rows''. This nomenclature is derived from the usual notation used to write down linear models: in the shape of a matrix.
The variables (columns) of MESSAGE be grouped into three categories:

1. Energy flow variables representing an annual energy flow quantity. The unit is usually GWyr for larger regions,
2. Power variables representing the production capacity of a technology (usual unit: GW), and
3. Stock-piles representing the quantity of a fuel being cumulated at a certain point in time (usual unit: GWyr).

The constraints (rows) generated by MESSAGE can be grouped into the following categories:

1. Energy flow balances modelling the flow of energy in the energy chain from resource extraction via conversion, transport, distribution up to final utilization,
2. sum or relational constraints limiting aggregate activities on an annual or cumulative basis, either absolute or in relation to other activities,
3. dynamic constraints setting a relation between the activities of two consecutive periods, and
4. counters that are only used for accounting purposes.

This manual gives the mathematical formulation of MESSAGE. It contains a formalized description of all types of variables and equations that the matrix generator generates. 
The reader of this paper is assumed to be familiar with the theory of linear and mixed integer programming. Each of the building stones of MESSAGE handled in a separate chapter, 
which is again subdivided into sections on columns and rows. The notation used for the variable and equation names is the same as in the MPS-file. Uppercase letters are used to 
indicate predefined identifiers, while lowercase letters represent characters that are chosen by the user or varied over a set of characters. In order to keep the notation simple and 
the mathematical description as short as possible the more complex features are omitted from the description of the rows and described in an additional section (see :ref:`specialfeatures`). 
Since practically all parameters of MESSAGE can be defined as time series (i.e. change over the planning horizon), the index for the period is often omitted in the formulation 
(e.g., for the efficiencies or the plant factors of conversion technologies).

The names of variables and equations used in this description follow the notation used in the mps and solution files of the problem. For variables and equations related to technologies this is generally \ *name*\ ....rrlllttt, I\ *name*\ ...rrlllttt, or :math:`\ *name*\ I...rrlllttt`, where :math:` *name*` is generated from main output level identifier, main input energy form identifier, a user given character, and the main output fuel identifier. I are indicators of related variables like e.g. annual investments or market penetration. For used defined equations and variables the name is supplied by the user. :math`rr` denotes the region ('..' for the main region of a multi-region model and for one-regional models). :math:`lll`denotes the load region (usually this is season index, day index and hour index all indexed feom a-Z). :math:`ttt` is the model time period, calculated as :mat:`year - int(year_0/100)*100`. 
